theory qcow_snapshot_delete
  imports
    "../../../isabelle/VCG/HTriple"
begin

locale "qemu_img_xen" = execution_context + exec_code +
  fixes find_snapshot_by_id_or_name_isra_9_0x15cf4_retval\<^sub>v update_snapshot_refcount_0x15d2d_retval\<^sub>v update_snapshot_refcount_0x15d49_retval\<^sub>v update_refcount_0x15d68_retval\<^sub>v qemu_free_0x15d71_retval\<^sub>v qemu_free_0x15d7a_retval\<^sub>v memmove_0x15da0_retval\<^sub>v qcow_write_snapshots_0x15db1_retval\<^sub>v find_snapshot_by_id_or_name_isra_9_addr memmove_addr qcow_write_snapshots_addr qemu_free_addr update_refcount_addr update_snapshot_refcount_addr :: \<open>64 word\<close>
    and find_snapshot_by_id_or_name_isra_9_acode memmove_acode qcow_write_snapshots_acode qemu_free_acode update_refcount_acode update_snapshot_refcount_acode :: ACode
  assumes fetch:
    "fetch 0x15ce0 \<equiv> (Unary (IS_8088 Push) (Storage (Reg (General SixtyFour r13))), 2)"
    "fetch 0x15ce2 \<equiv> (Unary (IS_8088 Push) (Storage (Reg (General SixtyFour r12))), 2)"
    "fetch 0x15ce4 \<equiv> (Unary (IS_8088 Push) (Storage (Reg (General SixtyFour rbp))), 1)"
    "fetch 0x15ce5 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rbp)) (Storage (Reg (General SixtyFour rdi))), 3)"
    "fetch 0x15ce8 \<equiv> (Unary (IS_8088 Push) (Storage (Reg (General SixtyFour rbx))), 1)"
    "fetch 0x15ce9 \<equiv> (Binary (IS_8088 Sub) (Reg (General SixtyFour rsp)) (Immediate SixtyFour (ImmVal 8)), 4)"
    "fetch 0x15ced \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour r12)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour rdi)) (A_WordConstant 64))))), 4)"
    "fetch 0x15cf1 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour r12))), 3)"
    "fetch 0x15cf4 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''find_snapshot_by_id_or_name.isra.9'')), 5)"
    "fetch 0x15cf9 \<equiv> (Binary (IS_8088 Test) (Reg (General ThirtyTwo rax)) (Storage (Reg (General ThirtyTwo rax))), 2)"
    "fetch 0x15cfb \<equiv> (Unary (IS_8088 Js) (Immediate SixtyFour (ImmVal 89552)), 6)"
    "fetch 0x15d01 \<equiv> (Binary (IS_X86_64 Movsxd) (Reg (General SixtyFour rdx)) (Storage (Reg (General ThirtyTwo rax))), 3)"
    "fetch 0x15d04 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rbx)) (Storage (Reg (General ThirtyTwo rax))), 2)"
    "fetch 0x15d06 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rcx)) (Immediate SixtyFour (ImmVal 4294967295)), 5)"
    "fetch 0x15d0b \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour rbp))), 3)"
    "fetch 0x15d0e \<equiv> (Binary (IS_8088 Lea) (Reg (General SixtyFour rax)) (Storage (Memory SixtyFour (A_Plus (A_Mult 8 (A_FromReg (General SixtyFour rdx))) (A_WordConstant 0)))), 8)"
    "fetch 0x15d16 \<equiv> (Binary (IS_8088 Sub) (Reg (General SixtyFour rax)) (Storage (Reg (General SixtyFour rdx))), 3)"
    "fetch 0x15d19 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdx)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r12)) (A_WordConstant 864))))), 8)"
    "fetch 0x15d21 \<equiv> (Binary (IS_8088 Lea) (Reg (General SixtyFour r13)) (Storage (Memory SixtyFour (A_Plus (A_FromReg (General SixtyFour rdx)) (A_Mult 8 (A_FromReg (General SixtyFour rax)))))), 4)"
    "fetch 0x15d25 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rdx)) (Storage (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 8))))), 4)"
    "fetch 0x15d29 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rsi)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 0))))), 4)"
    "fetch 0x15d2d \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''update_snapshot_refcount'')), 5)"
    "fetch 0x15d32 \<equiv> (Binary (IS_8088 Test) (Reg (General ThirtyTwo rax)) (Storage (Reg (General ThirtyTwo rax))), 2)"
    "fetch 0x15d34 \<equiv> (Unary (IS_8088 Js) (Immediate SixtyFour (ImmVal 89536)), 6)"
    "fetch 0x15d3a \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rdx)) (Storage (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour r12)) (A_WordConstant 28))))), 5)"
    "fetch 0x15d3f \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rsi)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r12)) (A_WordConstant 56))))), 5)"
    "fetch 0x15d44 \<equiv> (Binary (IS_8088 Xor) (Reg (General ThirtyTwo rcx)) (Storage (Reg (General ThirtyTwo rcx))), 2)"
    "fetch 0x15d46 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour rbp))), 3)"
    "fetch 0x15d49 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''update_snapshot_refcount'')), 5)"
    "fetch 0x15d4e \<equiv> (Binary (IS_8088 Test) (Reg (General ThirtyTwo rax)) (Storage (Reg (General ThirtyTwo rax))), 2)"
    "fetch 0x15d50 \<equiv> (Unary (IS_8088 Js) (Immediate SixtyFour (ImmVal 89536)), 2)"
    "fetch 0x15d52 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rdx)) (Storage (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 8))))), 4)"
    "fetch 0x15d56 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rsi)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 0))))), 4)"
    "fetch 0x15d5a \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rcx)) (Immediate SixtyFour (ImmVal 4294967295)), 5)"
    "fetch 0x15d5f \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour rbp))), 3)"
    "fetch 0x15d62 \<equiv> (Unary (IS_8088 Not) (Storage (Reg (General ThirtyTwo rbx))), 2)"
    "fetch 0x15d64 \<equiv> (Binary (IS_8088 Shl) (Reg (General SixtyFour rdx)) (Immediate SixtyFour (ImmVal 3)), 4)"
    "fetch 0x15d68 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''update_refcount'')), 5)"
    "fetch 0x15d6d \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 16))))), 4)"
    "fetch 0x15d71 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''qemu_free'')), 5)"
    "fetch 0x15d76 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Memory SixtyFour (A_SizeDirective 64 (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 24))))), 4)"
    "fetch 0x15d7a \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''qemu_free'')), 5)"
    "fetch 0x15d7f \<equiv> (Binary (IS_8088 Add) (Reg (General ThirtyTwo rbx)) (Storage (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour r12)) (A_WordConstant 860))))), 8)"
    "fetch 0x15d87 \<equiv> (Binary (IS_8088 Lea) (Reg (General SixtyFour rsi)) (Storage (Memory SixtyFour (A_Plus (A_FromReg (General SixtyFour r13)) (A_WordConstant 56)))), 4)"
    "fetch 0x15d8b \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour r13))), 3)"
    "fetch 0x15d8e \<equiv> (Binary (IS_X86_64 Movsxd) (Reg (General SixtyFour rbx)) (Storage (Reg (General ThirtyTwo rbx))), 3)"
    "fetch 0x15d91 \<equiv> (Binary (IS_8088 Lea) (Reg (General SixtyFour rdx)) (Storage (Memory SixtyFour (A_Plus (A_Mult 8 (A_FromReg (General SixtyFour rbx))) (A_WordConstant 0)))), 8)"
    "fetch 0x15d99 \<equiv> (Binary (IS_8088 Sub) (Reg (General SixtyFour rdx)) (Storage (Reg (General SixtyFour rbx))), 3)"
    "fetch 0x15d9c \<equiv> (Binary (IS_8088 Shl) (Reg (General SixtyFour rdx)) (Immediate SixtyFour (ImmVal 3)), 4)"
    "fetch 0x15da0 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''memmove'')), 5)"
    "fetch 0x15da5 \<equiv> (Binary (IS_8088 Mov) (Reg (General SixtyFour rdi)) (Storage (Reg (General SixtyFour rbp))), 3)"
    "fetch 0x15da8 \<equiv> (Binary (IS_8088 Sub) (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour r12)) (A_WordConstant 860)))) (Immediate SixtyFour (ImmVal 1)), 9)"
    "fetch 0x15db1 \<equiv> (Unary (IS_8088 Call) (Immediate SixtyFour (ImmLabel ''qcow_write_snapshots'')), 5)"
    "fetch 0x15db6 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rdx)) (Immediate SixtyFour (ImmVal 0)), 5)"
    "fetch 0x15dbb \<equiv> (Binary (IS_8088 Test) (Reg (General ThirtyTwo rax)) (Storage (Reg (General ThirtyTwo rax))), 2)"
    "fetch 0x15dbd \<equiv> (Binary (IS_PentiumPro Cmovg) (Reg (General ThirtyTwo rax)) (Storage (Reg (General ThirtyTwo rdx))), 3)"
    "fetch 0x15dc0 \<equiv> (Binary (IS_8088 Add) (Reg (General SixtyFour rsp)) (Immediate SixtyFour (ImmVal 8)), 4)"
    "fetch 0x15dc4 \<equiv> (Unary (IS_8088 Pop) (Storage (Reg (General SixtyFour rbx))), 1)"
    "fetch 0x15dc5 \<equiv> (Unary (IS_8088 Pop) (Storage (Reg (General SixtyFour rbp))), 1)"
    "fetch 0x15dc6 \<equiv> (Unary (IS_8088 Pop) (Storage (Reg (General SixtyFour r12))), 2)"
    "fetch 0x15dc8 \<equiv> (Unary (IS_8088 Pop) (Storage (Reg (General SixtyFour r13))), 2)"
    "fetch 0x15dca \<equiv> (Nullary (IS_8088 Ret), 1)"
    "fetch 0x15dcb \<equiv> (Unary (IS_8088 Nop) (Storage (Memory ThirtyTwo (A_SizeDirective 32 (A_Plus (A_FromReg (General SixtyFour rax)) (A_Plus (A_Mult 1 (A_FromReg (General SixtyFour rax))) (A_WordConstant 0)))))), 5)"
    "fetch 0x15dd0 \<equiv> (Binary (IS_8088 Mov) (Reg (General ThirtyTwo rax)) (Immediate SixtyFour (ImmVal 4294967294)), 5)"
    "fetch 0x15dd5 \<equiv> (Unary (IS_8088 Jmp) (Immediate SixtyFour (ImmVal 89536)), 2)"
    and \<alpha>_def: \<open>\<alpha> = \<lparr>text_sections = [], data_sections = [], labels_to_offsets = [], binary_offset = 0\<rparr>\<close>
    and find_snapshot_by_id_or_name_isra_9\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''find_snapshot_by_id_or_name.isra.9'') = find_snapshot_by_id_or_name_isra_9_addr\<close>
    and memmove\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''memmove'') = memmove_addr\<close>
    and qcow_write_snapshots\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''qcow_write_snapshots'') = qcow_write_snapshots_addr\<close>
    and qemu_free\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''qemu_free'') = qemu_free_addr\<close>
    and update_refcount\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''update_refcount'') = update_refcount_addr\<close>
    and update_snapshot_refcount\<^sub>a\<^sub>d\<^sub>d\<^sub>r[simp]: \<open>the (label_to_address \<alpha> ''update_snapshot_refcount'') = update_snapshot_refcount_addr\<close>
begin

text \<open>Using definitions that don't get unfolded immediately prevents locale argument issues.\<close>
definition \<open>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval \<equiv> find_snapshot_by_id_or_name_isra_9_0x15cf4_retval\<^sub>v\<close>
definition \<open>update_snapshot_refcount_0x15d2d_retval \<equiv> update_snapshot_refcount_0x15d2d_retval\<^sub>v\<close>
definition \<open>update_snapshot_refcount_0x15d49_retval \<equiv> update_snapshot_refcount_0x15d49_retval\<^sub>v\<close>
definition \<open>update_refcount_0x15d68_retval \<equiv> update_refcount_0x15d68_retval\<^sub>v\<close>
definition \<open>qemu_free_0x15d71_retval \<equiv> qemu_free_0x15d71_retval\<^sub>v\<close>
definition \<open>qemu_free_0x15d7a_retval \<equiv> qemu_free_0x15d7a_retval\<^sub>v\<close>
definition \<open>memmove_0x15da0_retval \<equiv> memmove_0x15da0_retval\<^sub>v\<close>
definition \<open>qcow_write_snapshots_0x15db1_retval \<equiv> qcow_write_snapshots_0x15db1_retval\<^sub>v\<close>

text \<open>
  Going with a binary offset of 0 for now to make things easier. (We do want to keep that field
  around, though, for future more generic usage.)
\<close>
lemma \<alpha>_boffset[simp]: \<open>binary_offset \<alpha> = 0\<close>
  unfolding \<alpha>_def
  by simp

named_theorems blocks and Ps and Qs

method step uses add del =
  subst exec_block.simps,
  rewrite_one_let',
  rewrite_one_let' add: fetch,
  rewrite_one_let',
  auto simp add: simp_rules Let'_def read_region'_def write_block'_def get'_def set'_def step_def exec_instr_def presimplify add simp del: del

method steps uses pre post regionset add del =
  auto simp: pred_logic pre regionset,
  (step add: add del: del)+,
  (auto simp add: eq_def)[1],
  auto simp: block_usage_def eq_def setcc_def cmovcc_def if'_then_else_def sub_sign_flag_def simp_rules Let'_def read_region'_def write_block'_def get'_def set'_def post regionset

method vcg_step uses assms =
  ((rule htriples)+, rule blocks)+,
  (simp add: assms pred_logic Ps Qs)?,
  (((auto simp: eq_def)[])+)?

method vcg_step' uses assms =
  (rule htriples)+,
  simp,
  ((rule htriples)+, rule blocks)+,
  (simp add: assms pred_logic Ps Qs)?,
  (((auto simp: eq_def)[])+)?

method vcg_while for P :: state_pred uses assms =
  ((rule htriples)+)?,
  rule HTriple_weaken[where P=P],
  simp add: pred_logic Ps Qs assms,
  rule HTriple_while

method vcg uses acode assms =
  subst acode,
  (vcg_step assms: assms)+

end

locale "qcow_snapshot_delete" = "qemu_img_xen" +
  fixes RAX\<^sub>0\<^sub>v RBX\<^sub>0\<^sub>v RCX\<^sub>0\<^sub>v RDX\<^sub>0\<^sub>v RDI\<^sub>0\<^sub>v RSI\<^sub>0\<^sub>v RSP\<^sub>0\<^sub>v RBP\<^sub>0\<^sub>v R13\<^sub>0\<^sub>v R12\<^sub>0\<^sub>v ret_address\<^sub>v :: \<open>64 word\<close>
begin

text \<open>Using definitions that don't get unfolded immediately prevents locale argument issues.\<close>
definition \<open>RAX\<^sub>0 \<equiv> RAX\<^sub>0\<^sub>v\<close>
definition \<open>RBX\<^sub>0 \<equiv> RBX\<^sub>0\<^sub>v\<close>
definition \<open>RCX\<^sub>0 \<equiv> RCX\<^sub>0\<^sub>v\<close>
definition \<open>RDX\<^sub>0 \<equiv> RDX\<^sub>0\<^sub>v\<close>
definition \<open>RDI\<^sub>0 \<equiv> RDI\<^sub>0\<^sub>v\<close>
definition \<open>RSI\<^sub>0 \<equiv> RSI\<^sub>0\<^sub>v\<close>
definition \<open>RSP\<^sub>0 \<equiv> RSP\<^sub>0\<^sub>v\<close>
definition \<open>RBP\<^sub>0 \<equiv> RBP\<^sub>0\<^sub>v\<close>
definition \<open>R13\<^sub>0 \<equiv> R13\<^sub>0\<^sub>v\<close>
definition \<open>R12\<^sub>0 \<equiv> R12\<^sub>0\<^sub>v\<close>
definition \<open>ret_address \<equiv> ret_address\<^sub>v\<close>

definition P_0x15ce0_0 :: state_pred where
  \<open>P_0x15ce0_0 \<sigma> \<equiv> RIP \<sigma> = 0x15ce0 \<and> RAX \<sigma> = RAX\<^sub>0 \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = RSP\<^sub>0 \<and> RBP \<sigma> = RBP\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address\<close>
declare P_0x15ce0_0_def[Ps]

definition P_0x15ce0_0_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15ce0_0_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (3, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (4, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x20), 8)
  }\<close>

definition P_0x15ce0_0_regions :: state_pred where
  \<open>P_0x15ce0_0_regions \<sigma> \<equiv> \<exists>regions. P_0x15ce0_0_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15cf4_0 :: state_pred where
  \<open>Q_0x15cf4_0 \<sigma> \<equiv> RIP \<sigma> = 0x15cf4 \<and> RAX \<sigma> = RAX\<^sub>0 \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_0x15cf4_0_def[Qs]

schematic_goal qcow_snapshot_delete_0_8_0x15ce0_0x15cf1_0[blocks]:
  assumes \<open>(P_0x15ce0_0 && P_0x15ce0_0_regions) \<sigma>\<close>
  shows \<open>exec_block 8 0x15cf1 0 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15cf4_0 ?\<sigma> \<and> block_usage P_0x15ce0_0_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15ce0_0_def P_0x15ce0_0_regions_def post: Q_0x15cf4_0_def regionset: P_0x15ce0_0_regions_set_def)

definition P_0x15cf4_1 :: state_pred where
  \<open>P_0x15cf4_1 \<sigma> \<equiv> RIP \<sigma> = 0x15cf4 \<and> RAX \<sigma> = RAX\<^sub>0 \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare P_0x15cf4_1_def[Ps]

definition P_0x15cf4_1_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15cf4_1_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (3, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (4, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15cf4_1_regions :: state_pred where
  \<open>P_0x15cf4_1_regions \<sigma> \<equiv> \<exists>regions. P_0x15cf4_1_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1 :: state_pred where
  \<open>Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = find_snapshot_by_id_or_name_isra_9_addr \<and> RAX \<sigma> = RAX\<^sub>0 \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15cf4_0x15cf4_1[blocks]:
  assumes \<open>(P_0x15cf4_1 && P_0x15cf4_1_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15cf4 (Suc 0) \<sigma> \<triangleq> ?\<sigma> \<and> Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1 ?\<sigma> \<and> block_usage P_0x15cf4_1_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15cf4_1_def P_0x15cf4_1_regions_def post: Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1_def regionset: P_0x15cf4_1_regions_set_def)

definition P_0x15cf9_2 :: state_pred where
  \<open>P_0x15cf9_2 \<sigma> \<equiv> RIP \<sigma> = 0x15cf9 \<and> RAX \<sigma> = find_snapshot_by_id_or_name_isra_9_0x15cf4_retval \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare P_0x15cf9_2_def[Ps]

definition P_0x15cf9_2_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15cf9_2_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (3, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (4, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15cf9_2_regions :: state_pred where
  \<open>P_0x15cf9_2_regions \<sigma> \<equiv> \<exists>regions. P_0x15cf9_2_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15cfb_2 :: state_pred where
  \<open>Q_0x15cfb_2 \<sigma> \<equiv> RIP \<sigma> = 0x15cfb \<and> RAX \<sigma> = find_snapshot_by_id_or_name_isra_9_0x15cf4_retval \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare Q_0x15cfb_2_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15cf9_0x15cf9_2[blocks]:
  assumes \<open>(P_0x15cf9_2 && P_0x15cf9_2_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15cf9 2 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15cfb_2 ?\<sigma> \<and> block_usage P_0x15cf9_2_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15cf9_2_def P_0x15cf9_2_regions_def post: Q_0x15cfb_2_def regionset: P_0x15cf9_2_regions_set_def)

definition P_0x15cfb_true_3 :: state_pred where
  \<open>P_0x15cfb_true_3 \<sigma> \<equiv> RIP \<sigma> = 0x15cfb \<and> RAX \<sigma> = find_snapshot_by_id_or_name_isra_9_0x15cf4_retval \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare P_0x15cfb_true_3_def[Ps]

definition P_0x15cfb_true_3_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15cfb_true_3_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (3, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (4, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15cfb_true_3_regions :: state_pred where
  \<open>P_0x15cfb_true_3_regions \<sigma> \<equiv> \<exists>regions. P_0x15cfb_true_3_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15dc0_3 :: state_pred where
  \<open>Q_0x15dc0_3 \<sigma> \<equiv> RIP \<sigma> = 0x15dc0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_0x15dc0_3_def[Qs]

schematic_goal qcow_snapshot_delete_0_3_0x15cfb_0x15dd5_3[blocks]:
  assumes \<open>(P_0x15cfb_true_3 && P_0x15cfb_true_3_regions && SF) \<sigma>\<close>
  shows \<open>exec_block 3 0x15dd5 3 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15dc0_3 ?\<sigma> \<and> block_usage P_0x15cfb_true_3_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15cfb_true_3_def P_0x15cfb_true_3_regions_def post: Q_0x15dc0_3_def regionset: P_0x15cfb_true_3_regions_set_def)

definition P_0x15cfb_false_4 :: state_pred where
  \<open>P_0x15cfb_false_4 \<sigma> \<equiv> RIP \<sigma> = 0x15cfb \<and> RAX \<sigma> = find_snapshot_by_id_or_name_isra_9_0x15cf4_retval \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RCX \<sigma> = RCX\<^sub>0 \<and> RDX \<sigma> = RDX\<^sub>0 \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> RSI \<sigma> = RSI\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare P_0x15cfb_false_4_def[Ps]

definition P_0x15cfb_false_4_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15cfb_false_4_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (4, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15cfb_false_4_regions :: state_pred where
  \<open>P_0x15cfb_false_4_regions \<sigma> \<equiv> \<exists>regions. P_0x15cfb_false_4_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d2d_4 :: state_pred where
  \<open>Q_0x15d2d_4 \<sigma> \<equiv> RIP \<sigma> = 0x15d2d \<and> RAX \<sigma> = (((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)) \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare Q_0x15d2d_4_def[Qs]

schematic_goal qcow_snapshot_delete_0_11_0x15cfb_0x15d29_4[blocks]:
  assumes \<open>(P_0x15cfb_false_4 && P_0x15cfb_false_4_regions && ! SF) \<sigma>\<close>
  shows \<open>exec_block 11 0x15d29 4 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d2d_4 ?\<sigma> \<and> block_usage P_0x15cfb_false_4_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15cfb_false_4_def P_0x15cfb_false_4_regions_def post: Q_0x15d2d_4_def regionset: P_0x15cfb_false_4_regions_set_def)

definition P_0x15d2d_5 :: state_pred where
  \<open>P_0x15d2d_5 \<sigma> \<equiv> RIP \<sigma> = 0x15d2d \<and> RAX \<sigma> = (((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)) \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15cf9\<close>
declare P_0x15d2d_5_def[Ps]

definition P_0x15d2d_5_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d2d_5_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (4, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d2d_5_regions :: state_pred where
  \<open>P_0x15d2d_5_regions \<sigma> \<equiv> \<exists>regions. P_0x15d2d_5_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_update_snapshot_refcount_addr_0x15d2d_5 :: state_pred where
  \<open>Q_update_snapshot_refcount_addr_0x15d2d_5 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = update_snapshot_refcount_addr \<and> RAX \<sigma> = (((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)) \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare Q_update_snapshot_refcount_addr_0x15d2d_5_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d2d_0x15d2d_5[blocks]:
  assumes \<open>(P_0x15d2d_5 && P_0x15d2d_5_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d2d 5 \<sigma> \<triangleq> ?\<sigma> \<and> Q_update_snapshot_refcount_addr_0x15d2d_5 ?\<sigma> \<and> block_usage P_0x15d2d_5_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d2d_5_def P_0x15d2d_5_regions_def post: Q_update_snapshot_refcount_addr_0x15d2d_5_def regionset: P_0x15d2d_5_regions_set_def)

definition P_0x15d32_6 :: state_pred where
  \<open>P_0x15d32_6 \<sigma> \<equiv> RIP \<sigma> = 0x15d32 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare P_0x15d32_6_def[Ps]

definition P_0x15d32_6_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d32_6_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (4, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d32_6_regions :: state_pred where
  \<open>P_0x15d32_6_regions \<sigma> \<equiv> \<exists>regions. P_0x15d32_6_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d34_6 :: state_pred where
  \<open>Q_0x15d34_6 \<sigma> \<equiv> RIP \<sigma> = 0x15d34 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare Q_0x15d34_6_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d32_0x15d32_6[blocks]:
  assumes \<open>(P_0x15d32_6 && P_0x15d32_6_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d32 6 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d34_6 ?\<sigma> \<and> block_usage P_0x15d32_6_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d32_6_def P_0x15d32_6_regions_def post: Q_0x15d34_6_def regionset: P_0x15d32_6_regions_set_def)

definition P_0x15d34_true_7 :: state_pred where
  \<open>P_0x15d34_true_7 \<sigma> \<equiv> RIP \<sigma> = 0x15d34 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare P_0x15d34_true_7_def[Ps]

definition P_0x15d34_true_7_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d34_true_7_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (4, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (6, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d34_true_7_regions :: state_pred where
  \<open>P_0x15d34_true_7_regions \<sigma> \<equiv> \<exists>regions. P_0x15d34_true_7_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15dc0_7 :: state_pred where
  \<open>Q_0x15dc0_7 \<sigma> \<equiv> RIP \<sigma> = 0x15dc0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_0x15dc0_7_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d34_0x15d34_7[blocks]:
  assumes \<open>(P_0x15d34_true_7 && P_0x15d34_true_7_regions && SF) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d34 7 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15dc0_7 ?\<sigma> \<and> block_usage P_0x15d34_true_7_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d34_true_7_def P_0x15d34_true_7_regions_def post: Q_0x15dc0_7_def regionset: P_0x15d34_true_7_regions_set_def)

definition P_0x15d34_false_8 :: state_pred where
  \<open>P_0x15d34_false_8 \<sigma> \<equiv> RIP \<sigma> = 0x15d34 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare P_0x15d34_false_8_def[Ps]

definition P_0x15d34_false_8_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d34_false_8_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d34_false_8_regions :: state_pred where
  \<open>P_0x15d34_false_8_regions \<sigma> \<equiv> \<exists>regions. P_0x15d34_false_8_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d49_8 :: state_pred where
  \<open>Q_0x15d49_8 \<sigma> \<equiv> RIP \<sigma> = 0x15d49 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare Q_0x15d49_8_def[Qs]

schematic_goal qcow_snapshot_delete_0_5_0x15d34_0x15d46_8[blocks]:
  assumes \<open>(P_0x15d34_false_8 && P_0x15d34_false_8_regions && ! SF) \<sigma>\<close>
  shows \<open>exec_block 5 0x15d46 8 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d49_8 ?\<sigma> \<and> block_usage P_0x15d34_false_8_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d34_false_8_def P_0x15d34_false_8_regions_def post: Q_0x15d49_8_def regionset: P_0x15d34_false_8_regions_set_def)

definition P_0x15d49_9 :: state_pred where
  \<open>P_0x15d49_9 \<sigma> \<equiv> RIP \<sigma> = 0x15d49 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d32\<close>
declare P_0x15d49_9_def[Ps]

definition P_0x15d49_9_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d49_9_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d49_9_regions :: state_pred where
  \<open>P_0x15d49_9_regions \<sigma> \<equiv> \<exists>regions. P_0x15d49_9_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_update_snapshot_refcount_addr_0x15d49_9 :: state_pred where
  \<open>Q_update_snapshot_refcount_addr_0x15d49_9 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = update_snapshot_refcount_addr \<and> RAX \<sigma> = update_snapshot_refcount_0x15d2d_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare Q_update_snapshot_refcount_addr_0x15d49_9_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d49_0x15d49_9[blocks]:
  assumes \<open>(P_0x15d49_9 && P_0x15d49_9_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d49 9 \<sigma> \<triangleq> ?\<sigma> \<and> Q_update_snapshot_refcount_addr_0x15d49_9 ?\<sigma> \<and> block_usage P_0x15d49_9_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d49_9_def P_0x15d49_9_regions_def post: Q_update_snapshot_refcount_addr_0x15d49_9_def regionset: P_0x15d49_9_regions_set_def)

definition P_0x15d4e_10 :: state_pred where
  \<open>P_0x15d4e_10 \<sigma> \<equiv> RIP \<sigma> = 0x15d4e \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare P_0x15d4e_10_def[Ps]

definition P_0x15d4e_10_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d4e_10_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d4e_10_regions :: state_pred where
  \<open>P_0x15d4e_10_regions \<sigma> \<equiv> \<exists>regions. P_0x15d4e_10_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d50_10 :: state_pred where
  \<open>Q_0x15d50_10 \<sigma> \<equiv> RIP \<sigma> = 0x15d50 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare Q_0x15d50_10_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d4e_0x15d4e_10[blocks]:
  assumes \<open>(P_0x15d4e_10 && P_0x15d4e_10_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d4e 10 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d50_10 ?\<sigma> \<and> block_usage P_0x15d4e_10_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d4e_10_def P_0x15d4e_10_regions_def post: Q_0x15d50_10_def regionset: P_0x15d4e_10_regions_set_def)

definition P_0x15d50_true_11 :: state_pred where
  \<open>P_0x15d50_true_11 \<sigma> \<equiv> RIP \<sigma> = 0x15d50 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare P_0x15d50_true_11_def[Ps]

definition P_0x15d50_true_11_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d50_true_11_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d50_true_11_regions :: state_pred where
  \<open>P_0x15d50_true_11_regions \<sigma> \<equiv> \<exists>regions. P_0x15d50_true_11_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15dc0_11 :: state_pred where
  \<open>Q_0x15dc0_11 \<sigma> \<equiv> RIP \<sigma> = 0x15dc0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_0x15dc0_11_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d50_0x15d50_11[blocks]:
  assumes \<open>(P_0x15d50_true_11 && P_0x15d50_true_11_regions && SF) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d50 11 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15dc0_11 ?\<sigma> \<and> block_usage P_0x15d50_true_11_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d50_true_11_def P_0x15d50_true_11_regions_def post: Q_0x15dc0_11_def regionset: P_0x15d50_true_11_regions_set_def)

definition P_0x15d50_false_12 :: state_pred where
  \<open>P_0x15d50_false_12 \<sigma> \<equiv> RIP \<sigma> = 0x15d50 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)) \<and> RCX \<sigma> = 0x0 \<and> RDX \<sigma> = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare P_0x15d50_false_12_def[Ps]

definition P_0x15d50_false_12_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d50_false_12_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d50_false_12_regions :: state_pred where
  \<open>P_0x15d50_false_12_regions \<sigma> \<equiv> \<exists>regions. P_0x15d50_false_12_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d68_12 :: state_pred where
  \<open>Q_0x15d68_12 \<sigma> \<equiv> RIP \<sigma> = 0x15d68 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare Q_0x15d68_12_def[Qs]

schematic_goal qcow_snapshot_delete_0_7_0x15d50_0x15d64_12[blocks]:
  assumes \<open>(P_0x15d50_false_12 && P_0x15d50_false_12_regions && ! SF) \<sigma>\<close>
  shows \<open>exec_block 7 0x15d64 12 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d68_12 ?\<sigma> \<and> block_usage P_0x15d50_false_12_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d50_false_12_def P_0x15d50_false_12_regions_def post: Q_0x15d68_12_def regionset: P_0x15d50_false_12_regions_set_def)

definition P_0x15d68_13 :: state_pred where
  \<open>P_0x15d68_13 \<sigma> \<equiv> RIP \<sigma> = 0x15d68 \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d4e\<close>
declare P_0x15d68_13_def[Ps]

definition P_0x15d68_13_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d68_13_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (6, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (7, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d68_13_regions :: state_pred where
  \<open>P_0x15d68_13_regions \<sigma> \<equiv> \<exists>regions. P_0x15d68_13_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_update_refcount_addr_0x15d68_13 :: state_pred where
  \<open>Q_update_refcount_addr_0x15d68_13 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = update_refcount_addr \<and> RAX \<sigma> = update_snapshot_refcount_0x15d49_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d6d\<close>
declare Q_update_refcount_addr_0x15d68_13_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d68_0x15d68_13[blocks]:
  assumes \<open>(P_0x15d68_13 && P_0x15d68_13_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d68 13 \<sigma> \<triangleq> ?\<sigma> \<and> Q_update_refcount_addr_0x15d68_13 ?\<sigma> \<and> block_usage P_0x15d68_13_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d68_13_def P_0x15d68_13_regions_def post: Q_update_refcount_addr_0x15d68_13_def regionset: P_0x15d68_13_regions_set_def)

definition P_0x15d6d_14 :: state_pred where
  \<open>P_0x15d6d_14 \<sigma> \<equiv> RIP \<sigma> = 0x15d6d \<and> RAX \<sigma> = update_refcount_0x15d68_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d6d\<close>
declare P_0x15d6d_14_def[Ps]

definition P_0x15d6d_14_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d6d_14_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (7, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d6d_14_regions :: state_pred where
  \<open>P_0x15d6d_14_regions \<sigma> \<equiv> \<exists>regions. P_0x15d6d_14_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d71_14 :: state_pred where
  \<open>Q_0x15d71_14 \<sigma> \<equiv> RIP \<sigma> = 0x15d71 \<and> RAX \<sigma> = update_refcount_0x15d68_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d6d\<close>
declare Q_0x15d71_14_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d6d_0x15d6d_14[blocks]:
  assumes \<open>(P_0x15d6d_14 && P_0x15d6d_14_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d6d 14 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d71_14 ?\<sigma> \<and> block_usage P_0x15d6d_14_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d6d_14_def P_0x15d6d_14_regions_def post: Q_0x15d71_14_def regionset: P_0x15d6d_14_regions_set_def)

definition P_0x15d71_15 :: state_pred where
  \<open>P_0x15d71_15 \<sigma> \<equiv> RIP \<sigma> = 0x15d71 \<and> RAX \<sigma> = update_refcount_0x15d68_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d6d\<close>
declare P_0x15d71_15_def[Ps]

definition P_0x15d71_15_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d71_15_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (7, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (8, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d71_15_regions :: state_pred where
  \<open>P_0x15d71_15_regions \<sigma> \<equiv> \<exists>regions. P_0x15d71_15_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_qemu_free_addr_0x15d71_15 :: state_pred where
  \<open>Q_qemu_free_addr_0x15d71_15 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = qemu_free_addr \<and> RAX \<sigma> = update_refcount_0x15d68_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d76\<close>
declare Q_qemu_free_addr_0x15d71_15_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d71_0x15d71_15[blocks]:
  assumes \<open>(P_0x15d71_15 && P_0x15d71_15_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d71 15 \<sigma> \<triangleq> ?\<sigma> \<and> Q_qemu_free_addr_0x15d71_15 ?\<sigma> \<and> block_usage P_0x15d71_15_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d71_15_def P_0x15d71_15_regions_def post: Q_qemu_free_addr_0x15d71_15_def regionset: P_0x15d71_15_regions_set_def)

definition P_0x15d76_16 :: state_pred where
  \<open>P_0x15d76_16 \<sigma> \<equiv> RIP \<sigma> = 0x15d76 \<and> RAX \<sigma> = qemu_free_0x15d71_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d76\<close>
declare P_0x15d76_16_def[Ps]

definition P_0x15d76_16_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d76_16_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (8, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d76_16_regions :: state_pred where
  \<open>P_0x15d76_16_regions \<sigma> \<equiv> \<exists>regions. P_0x15d76_16_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15d7a_16 :: state_pred where
  \<open>Q_0x15d7a_16 \<sigma> \<equiv> RIP \<sigma> = 0x15d7a \<and> RAX \<sigma> = qemu_free_0x15d71_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d76\<close>
declare Q_0x15d7a_16_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d76_0x15d76_16[blocks]:
  assumes \<open>(P_0x15d76_16 && P_0x15d76_16_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d76 16 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15d7a_16 ?\<sigma> \<and> block_usage P_0x15d76_16_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d76_16_def P_0x15d76_16_regions_def post: Q_0x15d7a_16_def regionset: P_0x15d76_16_regions_set_def)

definition P_0x15d7a_17 :: state_pred where
  \<open>P_0x15d7a_17 \<sigma> \<equiv> RIP \<sigma> = 0x15d7a \<and> RAX \<sigma> = qemu_free_0x15d71_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d76\<close>
declare P_0x15d7a_17_def[Ps]

definition P_0x15d7a_17_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d7a_17_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (8, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d7a_17_regions :: state_pred where
  \<open>P_0x15d7a_17_regions \<sigma> \<equiv> \<exists>regions. P_0x15d7a_17_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_qemu_free_addr_0x15d7a_17 :: state_pred where
  \<open>Q_qemu_free_addr_0x15d7a_17 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = qemu_free_addr \<and> RAX \<sigma> = qemu_free_0x15d71_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d7f\<close>
declare Q_qemu_free_addr_0x15d7a_17_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15d7a_0x15d7a_17[blocks]:
  assumes \<open>(P_0x15d7a_17 && P_0x15d7a_17_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15d7a 17 \<sigma> \<triangleq> ?\<sigma> \<and> Q_qemu_free_addr_0x15d7a_17 ?\<sigma> \<and> block_usage P_0x15d7a_17_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d7a_17_def P_0x15d7a_17_regions_def post: Q_qemu_free_addr_0x15d7a_17_def regionset: P_0x15d7a_17_regions_set_def)

definition P_0x15d7f_18 :: state_pred where
  \<open>P_0x15d7f_18 \<sigma> \<equiv> RIP \<sigma> = 0x15d7f \<and> RAX \<sigma> = qemu_free_0x15d7a_retval \<and> RBX \<sigma> = ucast ((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)::32 word))::64 word) << 3) \<and> RDI \<sigma> = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> RSI \<sigma> = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d7f\<close>
declare P_0x15d7f_18_def[Ps]

definition P_0x15d7f_18_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15d7f_18_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c), 4),
    (8, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (9, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (14, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15d7f_18_regions :: state_pred where
  \<open>P_0x15d7f_18_regions \<sigma> \<equiv> \<exists>regions. P_0x15d7f_18_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15da0_18 :: state_pred where
  \<open>Q_0x15da0_18 \<sigma> \<equiv> RIP \<sigma> = 0x15da0 \<and> RAX \<sigma> = qemu_free_0x15d7a_retval \<and> RBX \<sigma> = (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word))::64 word))::64 word) << 3) \<and> RDI \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d7f\<close>
declare Q_0x15da0_18_def[Qs]

schematic_goal qcow_snapshot_delete_0_7_0x15d7f_0x15d9c_18[blocks]:
  assumes \<open>(P_0x15d7f_18 && P_0x15d7f_18_regions) \<sigma>\<close>
  shows \<open>exec_block 7 0x15d9c 18 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15da0_18 ?\<sigma> \<and> block_usage P_0x15d7f_18_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15d7f_18_def P_0x15d7f_18_regions_def post: Q_0x15da0_18_def regionset: P_0x15d7f_18_regions_set_def)

definition P_0x15da0_19 :: state_pred where
  \<open>P_0x15da0_19 \<sigma> \<equiv> RIP \<sigma> = 0x15da0 \<and> RAX \<sigma> = qemu_free_0x15d7a_retval \<and> RBX \<sigma> = (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word))::64 word))::64 word) << 3) \<and> RDI \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15d7f\<close>
declare P_0x15da0_19_def[Ps]

definition P_0x15da0_19_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15da0_19_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c), 4),
    (8, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (9, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (14, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15da0_19_regions :: state_pred where
  \<open>P_0x15da0_19_regions \<sigma> \<equiv> \<exists>regions. P_0x15da0_19_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_memmove_addr_0x15da0_19 :: state_pred where
  \<open>Q_memmove_addr_0x15da0_19 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = memmove_addr \<and> RAX \<sigma> = qemu_free_0x15d7a_retval \<and> RBX \<sigma> = (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word))::64 word))::64 word) << 3) \<and> RDI \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15da5\<close>
declare Q_memmove_addr_0x15da0_19_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15da0_0x15da0_19[blocks]:
  assumes \<open>(P_0x15da0_19 && P_0x15da0_19_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15da0 19 \<sigma> \<triangleq> ?\<sigma> \<and> Q_memmove_addr_0x15da0_19 ?\<sigma> \<and> block_usage P_0x15da0_19_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15da0_19_def P_0x15da0_19_regions_def post: Q_memmove_addr_0x15da0_19_def regionset: P_0x15da0_19_regions_set_def)

definition P_0x15da5_20 :: state_pred where
  \<open>P_0x15da5_20 \<sigma> \<equiv> RIP \<sigma> = 0x15da5 \<and> RAX \<sigma> = memmove_0x15da0_retval \<and> RBX \<sigma> = (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word) \<and> RCX \<sigma> = 0xffffffff \<and> RDX \<sigma> = ((ucast (((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((((NOT ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word)))::32 word) + (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)))) 32 64::64 word))::64 word))::64 word) << 3) \<and> RDI \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15da5\<close>
declare P_0x15da5_20_def[Ps]

definition P_0x15da5_20_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15da5_20_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x35c), 4),
    (8, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (9, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (14, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15da5_20_regions :: state_pred where
  \<open>P_0x15da5_20_regions \<sigma> \<equiv> \<exists>regions. P_0x15da5_20_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15db1_20 :: state_pred where
  \<open>Q_0x15db1_20 \<sigma> \<equiv> RIP \<sigma> = 0x15db1 \<and> RAX \<sigma> = memmove_0x15da0_retval \<and> RCX \<sigma> = 0xffffffff \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15da5\<close>
declare Q_0x15db1_20_def[Qs]

schematic_goal qcow_snapshot_delete_0_2_0x15da5_0x15da8_20[blocks]:
  assumes \<open>(P_0x15da5_20 && P_0x15da5_20_regions) \<sigma>\<close>
  shows \<open>exec_block 2 0x15da8 20 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15db1_20 ?\<sigma> \<and> block_usage P_0x15da5_20_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15da5_20_def P_0x15da5_20_regions_def post: Q_0x15db1_20_def regionset: P_0x15da5_20_regions_set_def)

definition P_0x15db1_21 :: state_pred where
  \<open>P_0x15db1_21 \<sigma> \<equiv> RIP \<sigma> = 0x15db1 \<and> RAX \<sigma> = memmove_0x15da0_retval \<and> RCX \<sigma> = 0xffffffff \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15da5\<close>
declare P_0x15db1_21_def[Ps]

definition P_0x15db1_21_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15db1_21_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (8, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15db1_21_regions :: state_pred where
  \<open>P_0x15db1_21_regions \<sigma> \<equiv> \<exists>regions. P_0x15db1_21_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_qcow_write_snapshots_addr_0x15db1_21 :: state_pred where
  \<open>Q_qcow_write_snapshots_addr_0x15db1_21 \<sigma> \<equiv> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x30) \<and> RIP \<sigma> = qcow_write_snapshots_addr \<and> RAX \<sigma> = memmove_0x15da0_retval \<and> RCX \<sigma> = 0xffffffff \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15db6\<close>
declare Q_qcow_write_snapshots_addr_0x15db1_21_def[Qs]

schematic_goal qcow_snapshot_delete_0_1_0x15db1_0x15db1_21[blocks]:
  assumes \<open>(P_0x15db1_21 && P_0x15db1_21_regions) \<sigma>\<close>
  shows \<open>exec_block (Suc 0) 0x15db1 21 \<sigma> \<triangleq> ?\<sigma> \<and> Q_qcow_write_snapshots_addr_0x15db1_21 ?\<sigma> \<and> block_usage P_0x15db1_21_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15db1_21_def P_0x15db1_21_regions_def post: Q_qcow_write_snapshots_addr_0x15db1_21_def regionset: P_0x15db1_21_regions_set_def)

definition P_0x15db6_22 :: state_pred where
  \<open>P_0x15db6_22 \<sigma> \<equiv> RIP \<sigma> = 0x15db6 \<and> RAX \<sigma> = qcow_write_snapshots_0x15db1_retval \<and> RCX \<sigma> = 0xffffffff \<and> RDI \<sigma> = RDI\<^sub>0 \<and> RSI \<sigma> = (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x38) \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R13 \<sigma> = (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)) \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) = (\<sigma> \<turnstile> *[(((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word) = ucast ((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c),4]::32 word)) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word) \<and> (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) = (\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x30),8]::64 word) = 0x15db6\<close>
declare P_0x15db6_22_def[Ps]

definition P_0x15db6_22_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15db6_22_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x8), 4),
    (3, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x10), 8),
    (4, (((((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word))::64 word) + 0x18), 8),
    (5, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x1c), 4),
    (6, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x38), 8),
    (7, (((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360), 8),
    (8, (((\<sigma> \<turnstile> *[(((\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word)::64 word) + 0x360),8]::64 word)::64 word) + (\<langle>63,0\<rangle>(((((\<langle>63,0\<rangle>(((\<langle>63,0\<rangle>(sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word)::64 word)::64 word) * 0x8)::64 word)::64 word) - (sextend (ucast ((\<langle>31,0\<rangle>find_snapshot_by_id_or_name_isra_9_0x15cf4_retval::32 word))) 32 64::64 word))::64 word) * 0x8)::64 word)), 8),
    (9, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (10, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (11, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (12, ((RSP\<^sub>0::64 word) - 0x20), 8),
    (13, ((RSP\<^sub>0::64 word) - 0x30), 8)
  }\<close>

definition P_0x15db6_22_regions :: state_pred where
  \<open>P_0x15db6_22_regions \<sigma> \<equiv> \<exists>regions. P_0x15db6_22_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_0x15dc0_22 :: state_pred where
  \<open>Q_0x15dc0_22 \<sigma> \<equiv> RIP \<sigma> = 0x15dc0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_0x15dc0_22_def[Qs]

schematic_goal qcow_snapshot_delete_0_3_0x15db6_0x15dbd_22[blocks]:
  assumes \<open>(P_0x15db6_22 && P_0x15db6_22_regions) \<sigma>\<close>
  shows \<open>exec_block 3 0x15dbd 22 \<sigma> \<triangleq> ?\<sigma> \<and> Q_0x15dc0_22 ?\<sigma> \<and> block_usage P_0x15db6_22_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15db6_22_def P_0x15db6_22_regions_def post: Q_0x15dc0_22_def regionset: P_0x15db6_22_regions_set_def)

definition P_0x15dc0_23 :: state_pred where
  \<open>P_0x15dc0_23 \<sigma> \<equiv> RIP \<sigma> = 0x15dc0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) - 0x28) \<and> RBP \<sigma> = RDI\<^sub>0 \<and> R12 \<sigma> = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare P_0x15dc0_23_def[Ps]

definition P_0x15dc0_23_regions_set :: \<open>state \<Rightarrow> (nat \<times> 64 word \<times> nat) set\<close> where
  \<open>P_0x15dc0_23_regions_set \<sigma> \<equiv> {
    (0, RSP\<^sub>0, 8),
    (1, ((RDI\<^sub>0::64 word) + 0x40), 8),
    (2, ((RSP\<^sub>0::64 word) - 0x8), 8),
    (3, ((RSP\<^sub>0::64 word) - 0x10), 8),
    (4, ((RSP\<^sub>0::64 word) - 0x18), 8),
    (5, ((RSP\<^sub>0::64 word) - 0x20), 8)
  }\<close>

definition P_0x15dc0_23_regions :: state_pred where
  \<open>P_0x15dc0_23_regions \<sigma> \<equiv> \<exists>regions. P_0x15dc0_23_regions_set \<sigma> \<subseteq> regions
  \<and> (\<forall>i r. (i, r) \<in> regions \<longrightarrow> no_block_overflow r)
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<sqsubseteq> r' = (i = i' \<or> (i, i') \<in> {}))
  \<and> (\<forall>i r i' r'. (i, r) \<in> regions \<longrightarrow> (i', r') \<in> regions \<longrightarrow> r \<bowtie> r' = (i \<noteq> i' \<and> (i, i') \<notin> {}))
\<close>

definition Q_ret_address_23 :: state_pred where
  \<open>Q_ret_address_23 \<sigma> \<equiv> RIP \<sigma> = ret_address \<and> RBX \<sigma> = RBX\<^sub>0 \<and> RSP \<sigma> = ((RSP\<^sub>0::64 word) + 0x8) \<and> RBP \<sigma> = RBP\<^sub>0 \<and> R13 \<sigma> = R13\<^sub>0 \<and> R12 \<sigma> = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[RSP\<^sub>0,8]::64 word) = ret_address \<and> (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) = (\<sigma> \<turnstile> *[((RDI\<^sub>0::64 word) + 0x40),8]::64 word) \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x8),8]::64 word) = R13\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x10),8]::64 word) = R12\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x18),8]::64 word) = RBP\<^sub>0 \<and> (\<sigma> \<turnstile> *[((RSP\<^sub>0::64 word) - 0x20),8]::64 word) = RBX\<^sub>0\<close>
declare Q_ret_address_23_def[Qs]

schematic_goal qcow_snapshot_delete_0_6_0x15dc0_0x15dca_23[blocks]:
  assumes \<open>(P_0x15dc0_23 && P_0x15dc0_23_regions) \<sigma>\<close>
  shows \<open>exec_block 6 0x15dca 23 \<sigma> \<triangleq> ?\<sigma> \<and> Q_ret_address_23 ?\<sigma> \<and> block_usage P_0x15dc0_23_regions_set \<sigma> ?\<sigma>\<close>
  using assms
  by (steps pre: P_0x15dc0_23_def P_0x15dc0_23_regions_def post: Q_ret_address_23_def regionset: P_0x15dc0_23_regions_set_def)

definition qcow_snapshot_delete_acode :: ACode where
  \<open>qcow_snapshot_delete_acode =
    Block 8 0x15cf1 0;
    Block (Suc 0) 0x15cf4 (Suc 0);
    CALL find_snapshot_by_id_or_name_isra_9_acode;
    Block (Suc 0) 0x15cf9 2;
    IF SF THEN
      Block 3 0x15dd5 3
    ELSE
      Block 11 0x15d29 4;
      Block (Suc 0) 0x15d2d 5;
      CALL update_snapshot_refcount_acode;
      Block (Suc 0) 0x15d32 6;
      IF SF THEN
        Block (Suc 0) 0x15d34 7
      ELSE
        Block 5 0x15d46 8;
        Block (Suc 0) 0x15d49 9;
        CALL update_snapshot_refcount_acode;
        Block (Suc 0) 0x15d4e 10;
        IF SF THEN
          Block (Suc 0) 0x15d50 11
        ELSE
          Block 7 0x15d64 12;
          Block (Suc 0) 0x15d68 13;
          CALL update_refcount_acode;
          Block (Suc 0) 0x15d6d 14;
          Block (Suc 0) 0x15d71 15;
          CALL qemu_free_acode;
          Block (Suc 0) 0x15d76 16;
          Block (Suc 0) 0x15d7a 17;
          CALL qemu_free_acode;
          Block 7 0x15d9c 18;
          Block (Suc 0) 0x15da0 19;
          CALL memmove_acode;
          Block 2 0x15da8 20;
          Block (Suc 0) 0x15db1 21;
          CALL qcow_write_snapshots_acode;
          Block 3 0x15dbd 22
        FI
      FI
    FI;
    Block 6 0x15dca 23
  \<close>

schematic_goal "qcow_snapshot_delete":
  assumes
    \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15cf4 \<longrightarrow> P_0x15cf4_1_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15cf9 \<longrightarrow> P_0x15cf9_2_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15cfb \<longrightarrow> P_0x15cfb_true_3_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15cfb \<longrightarrow> P_0x15cfb_false_4_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d2d \<longrightarrow> P_0x15d2d_5_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d32 \<longrightarrow> P_0x15d32_6_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d34 \<longrightarrow> P_0x15d34_true_7_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d34 \<longrightarrow> P_0x15d34_false_8_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d49 \<longrightarrow> P_0x15d49_9_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d4e \<longrightarrow> P_0x15d4e_10_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d50 \<longrightarrow> P_0x15d50_true_11_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d50 \<longrightarrow> P_0x15d50_false_12_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d68 \<longrightarrow> P_0x15d68_13_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d6d \<longrightarrow> P_0x15d6d_14_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d71 \<longrightarrow> P_0x15d71_15_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d76 \<longrightarrow> P_0x15d76_16_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d7a \<longrightarrow> P_0x15d7a_17_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15d7f \<longrightarrow> P_0x15d7f_18_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15da0 \<longrightarrow> P_0x15da0_19_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15da5 \<longrightarrow> P_0x15da5_20_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15db1 \<longrightarrow> P_0x15db1_21_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15db6 \<longrightarrow> P_0x15db6_22_regions \<sigma>\<close>
    and \<open>\<forall>\<sigma>. RIP \<sigma> = 0x15dc0 \<longrightarrow> P_0x15dc0_23_regions \<sigma>\<close>
    and [blocks]: \<open>{{Q_find_snapshot_by_id_or_name_isra_9_addr_0x15cf4_1}} \<box>find_snapshot_by_id_or_name_isra_9_acode {{P_0x15cf9_2;M_0x15cf4}}\<close>
    and [blocks]: \<open>{{Q_update_snapshot_refcount_addr_0x15d2d_5}} \<box>update_snapshot_refcount_acode {{P_0x15d32_6;M_0x15d2d}}\<close>
    and [blocks]: \<open>{{Q_update_snapshot_refcount_addr_0x15d49_9}} \<box>update_snapshot_refcount_acode {{P_0x15d4e_10;M_0x15d49}}\<close>
    and [blocks]: \<open>{{Q_update_refcount_addr_0x15d68_13}} \<box>update_refcount_acode {{P_0x15d6d_14;M_0x15d68}}\<close>
    and [blocks]: \<open>{{Q_qemu_free_addr_0x15d71_15}} \<box>qemu_free_acode {{P_0x15d76_16;M_0x15d71}}\<close>
    and [blocks]: \<open>{{Q_qemu_free_addr_0x15d7a_17}} \<box>qemu_free_acode {{P_0x15d7f_18;M_0x15d7a}}\<close>
    and [blocks]: \<open>{{Q_memmove_addr_0x15da0_19}} \<box>memmove_acode {{P_0x15da5_20;M_0x15da0}}\<close>
    and [blocks]: \<open>{{Q_qcow_write_snapshots_addr_0x15db1_21}} \<box>qcow_write_snapshots_acode {{P_0x15db6_22;M_0x15db1}}\<close>
  shows \<open>{{?P}} qcow_snapshot_delete_acode {{?Q;?M}}\<close>
  by (vcg acode: qcow_snapshot_delete_acode_def assms: assms)

end
